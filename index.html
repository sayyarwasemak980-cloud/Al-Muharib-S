<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ Ø³: Ù…ØºØ§Ù…Ø±Ø© Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ø£Ø­Ù…Ø±</title>
    <style>
        /* --- 1. Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ÙˆØ§Ù„Ø®Ø·ÙˆØ· --- */
        @import url('https://fonts.googleapis.com/css2?family=Lalezar&family=Tajawal:wght@400;700&display=swap');

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background-color: #000;
            font-family: 'Tajawal', sans-serif; color: white;
            user-select: none; -webkit-user-select: none;
        }

        #game-container { width: 100%; height: 100%; position: relative; }

        .scene {
            display: none; width: 100%; height: 100%; position: absolute;
            top: 0; left: 0; flex-direction: column; justify-content: center;
            align-items: center; background-size: cover; background-position: center;
        }

        .active { display: flex; }

        /* --- ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø§Ù„Ù„Ù‡Ø¨ Ø§Ù„Ù…Ø·ÙˆØ± --- */
        .fire-border {
            box-shadow: 
                inset 0 0 40px #ff4500,
                inset 0 0 60px #ff8c00,
                inset 0 0 80px #ff0000;
            animation: fire-pulse 2s infinite alternate;
            border: 4px solid #ff4500;
        }

        @keyframes fire-pulse {
            0% { box-shadow: inset 0 0 30px #ff4500, inset 0 0 50px #ff0000; filter: brightness(1); }
            100% { box-shadow: inset 0 0 60px #ff8c00, inset 0 0 100px #ff4500; filter: brightness(1.2); }
        }

        video { width: 100%; height: 100%; object-fit: cover; }
        img { max-width: 100%; max-height: 100%; }

        /* --- Ø§Ù„Ø£Ø²Ø±Ø§Ø± --- */
        .game-btn {
            background: linear-gradient(145deg, #e60000, #ff8c00);
            border: 3px solid #fff; padding: 15px 45px;
            font-size: 1.6rem; color: white; border-radius: 50px;
            cursor: pointer; font-family: 'Lalezar', cursive;
            transition: 0.3s; z-index: 100; margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        .game-btn:hover { transform: scale(1.05); filter: brightness(1.2); }
        .game-btn:active { transform: scale(0.95); }

        #start-btn-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: transparent; border: none; cursor: pointer; z-index: 999;
        }

        /* --- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨ (HUD) --- */
        #ammo-bar {
            position: absolute; top: 15px; left: 50%; transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.85); border: 3px solid #00ff00;
            padding: 12px 35px; border-radius: 30px; font-family: 'Lalezar', cursive;
            font-size: 1.6rem; z-index: 1000; display: none; color: #00ff00;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.4);
        }

        .falling-item { position: absolute; cursor: pointer; transition: transform 0.1s; z-index: 50; }
        
        #info-popup {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 85%; max-height: 80%; border: 6px solid #ffd700;
            border-radius: 20px; z-index: 2000; display: none;
            background: black; box-shadow: 0 0 60px rgba(255, 215, 0, 0.6);
        }

        /* --- Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø­ØµÙ† --- */
        .quiz-box { background: rgba(0, 0, 0, 0.9); padding: 35px; border-radius: 25px; border: 3px solid #00aaff; width: 85%; }
        
        #motivation-text {
            color: #ffcc00; font-family: 'Lalezar'; font-size: 1.4rem;
            margin-bottom: 15px; text-shadow: 2px 2px 4px #000; padding: 0 10px;
        }

        #fort-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; width: 320px; margin-top: 20px; }
        .brick { 
            aspect-ratio: 1; background-color: #900; border: 2px solid #f00;
            background-image: url('ØªÙ†ÙŠÙ†.png'); background-size: 70%;
            background-position: center; background-repeat: no-repeat;
        }

        /* --- Ø§Ù„Ø®Ø§ØªÙ…Ø© --- */
        #typewriter { font-family: 'Courier New', monospace; font-size: 1.8rem; text-align: center; line-height: 1.8; }
        .highlight-hero { color: #ffd700; font-weight: bold; text-shadow: 0 0 10px #ffd700; }

    </style>
</head>
<body>

    <audio id="bg-music" src="sound 1.mp3" loop></audio>
    <audio id="typing-sound" src="sound 2.mp3"></audio>

    <div id="game-container">
        <div id="ammo-bar">Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ù†Ø§Ø¹Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©: <span id="score-val">0</span></div>

        <div id="scene-main" class="scene active" style="background-image: url('ÙˆØ§Ø¬Ù‡Ø©.png');">
            <button id="start-btn-overlay" onclick="startGame()"></button>
        </div>

        <div id="scene-video" class="scene" style="background: black;">
            <video id="main-video" playsinline></video>
            <button class="game-btn" onclick="skipVideo()" style="position: absolute; bottom: 20px; right: 20px; font-size: 1rem;">ØªØ®Ø·ÙŠ</button>
        </div>

        <div id="scene-image" class="scene fire-border">
            <img id="display-img" src="">
            <button id="scene-img-btn" class="game-btn" style="display:none; position:absolute; bottom:40px;"></button>
        </div>

        <div id="scene-gameplay" class="scene fire-border" style="background: radial-gradient(circle, #2b0000, #000);">
            <div id="game-area" style="width:100%; height:100%;"></div>
            <img id="info-popup" src="">
            <button id="next-level-btn" class="game-btn" style="position: absolute; bottom: 40px; display: none;" onclick="finishLevel()">Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©</button>
        </div>

        <div id="scene-quiz" class="scene fire-border" style="background: #000b1a;">
            <div class="quiz-box">
                <div id="quiz-question" style="font-family:Lalezar; font-size:2rem; color:#00aaff; margin-bottom:20px;"></div>
                <div id="quiz-options"></div>
                <p id="quiz-feedback" style="color: #00ff00; font-weight:bold; height: 30px;"></p>
            </div>
        </div>

        <div id="scene-boss" class="scene fire-border" style="background: #1a0000;">
            <div id="motivation-text">Ø­Ø§Ù† Ø§Ù„ÙˆÙ‚ØªØŒ Ø¬Ø§Ø¨Ù‡ Ø§Ù„ØªÙ†ÙŠÙ† ÙˆØ­Ø·Ù‘Ù… Ø­ØµÙ†Ù‡ Ø¨Ù…Ø§ ØªÙ…Ù„ÙƒÙ‡ Ù…Ù† Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ù†Ø§Ø¹Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©</div>
            <div style="font-family:Lalezar; font-size:2rem; color:red;">Ø§Ù„ÙˆÙ‚Ù€Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: <span id="timer-val">120</span></div>
            <div id="fort-grid"></div>
        </div>

        <div id="scene-lose" class="scene">
            <video id="lose-video" src="lose.mp4" playsinline style="width:100%; height:80%;"></video>
            <button class="game-btn" onclick="location.reload()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ğŸ”„</button>
        </div>

        <div id="scene-text-end" class="scene" style="background: #000;">
            <div id="typewriter"></div>
        </div>

        <div id="scene-final" class="scene">
            <video id="end-video" src="End.mp4" playsinline></video>
            <button id="home-btn" class="game-btn" style="display:none; position:absolute; bottom:40px;" onclick="location.reload()">Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ğŸ </button>
        </div>
    </div>

    <script>
        let score = 0;
        let currentLevel = 0;
        let spawnInterval;
        let bossInterval;
        let bossTimer = 120;
        let currentVideoCallback = null;
        let isPausedForInfo = false; // Ù…ØªØºÙŠØ± Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø³Ù‚ÙˆØ· Ù…Ø¤Ù‚ØªØ§Ù‹

        const assets = {
            images: {
                main: "ÙˆØ§Ø¬Ù‡Ø©.png",
                story: "Ù‚ØµØ© Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ Ø³.png",
                intro1: "Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø¨Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ - Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨.png",
                intro2: "Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø¨Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© - Ù…Ø±Ø­Ù„Ø© Ø§Ù„ÙˆÙ‚Ø§ÙŠØ©.png",
                intro3: "Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø¨Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© - Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¹Ù„Ø§Ø¬ ÙˆØ§Ù„Ù‚Ø¶Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ†ÙŠÙ†.png",
                l1Cards: ["Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰.png", "Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰.png", "Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø«Ø§Ù„Ø«Ø© Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰.png"],
                l2Cards: ["Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©.png", "Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©.png", "Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø«Ø§Ù„Ø«Ø© Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©.png"],
                l3Cards: ["Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©.png", "Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©.png", "Ø§Ù„Ø°Ø®ÙŠØ±Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ø§Ù„Ø«Ø§Ù„Ø«Ø© Ù…Ù† Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©.png"],
                bossReveal: "Ø­Ù‚ÙŠÙ‚Ø© Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ Ø³.png"
            }
        };

        const bgMusic = document.getElementById('bg-music');
        const typingSound = document.getElementById('typing-sound');

        function showScene(id) {
            document.querySelectorAll('.scene').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function startGame() {
            bgMusic.volume = 0.15;
            bgMusic.play().catch(e => {});
            playVideo("First.mp4", () => {
                showScene('scene-image');
                document.getElementById('display-img').src = assets.images.story;
                const btn = document.getElementById('scene-img-btn');
                btn.innerText = "Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰";
                btn.style.display = 'none';
                setTimeout(() => { btn.style.display = 'inline-block'; btn.onclick = () => goToLevel(1); }, 20000);
            });
        }

        function playVideo(src, callback) {
            showScene('scene-video');
            const v = document.getElementById('main-video');
            v.src = src;
            v.play();
            currentVideoCallback = callback;
            v.onended = () => { v.pause(); if(callback) callback(); };
        }

        function skipVideo() {
            const v = document.getElementById('main-video');
            v.pause();
            if(currentVideoCallback) currentVideoCallback();
        }

        function goToLevel(lvl) {
            currentLevel = lvl;
            document.getElementById('ammo-bar').style.display = 'block';
            if(lvl >= 1 && lvl <= 3) setupActionLevel(lvl);
            else if(lvl >= 4 && lvl <= 6) setupQuizLevel(lvl);
            else if(lvl === 7) startBossLevel();
        }

        function setupActionLevel(lvl) {
            playVideo(`level ${lvl}.mp4`, () => {
                showScene('scene-image');
                document.getElementById('display-img').src = assets.images[`intro${lvl}`];
                document.getElementById('scene-img-btn').style.display = 'none';
                setTimeout(() => runGameplay(lvl), 30000);
            });
        }

        function runGameplay(lvl) {
            showScene('scene-gameplay');
            const area = document.getElementById('game-area');
            area.innerHTML = '';
            document.getElementById('next-level-btn').style.display = 'none';
            let cardsPool = [...assets.images[`l${lvl}Cards`]];

            spawnInterval = setInterval(() => {
                if(isPausedForInfo) return; // Ù„Ø§ ØªØ³Ù‚Ø· Ø¹Ù†Ø§ØµØ± Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø¨Ø·Ø§Ù‚Ø© ØªÙÙ‚Ø±Ø£

                let rand = Math.random();
                if(rand < 0.05 && cardsPool.length > 0) spawnObject('card', cardsPool.shift());
                else if(rand < 0.15) spawnObject('bomb');
                else spawnObject('wbc');
            }, 900);

            setTimeout(() => { document.getElementById('next-level-btn').style.display = 'inline-block'; }, 50000);
        }

        function spawnObject(type, imgSrc = null) {
            const el = document.createElement('div');
            el.className = 'falling-item';
            el.style.left = Math.random() * (window.innerWidth - 70) + 'px';
            el.style.top = '-80px';
            
            if(type === 'wbc') el.innerHTML = '<span style="font-size:45px">âšª</span>';
            else if(type === 'bomb') el.innerHTML = '<span style="font-size:45px">ğŸ’£</span>';
            else if(type === 'card') el.innerHTML = '<span style="font-size:55px">ğŸ“œ</span>';

            let pos = -80;
            let fallSpeed = 2 + Math.random() * 2;
            let fallAnim = setInterval(() => {
                if(!isPausedForInfo) {
                    pos += fallSpeed;
                    el.style.top = pos + 'px';
                }
                if(pos > window.innerHeight) { clearInterval(fallAnim); if(el.parentNode) el.remove(); }
            }, 20);

            el.onpointerdown = () => {
                if(isPausedForInfo && type !== 'card') return;
                clearInterval(fallAnim); el.remove();
                if(type === 'wbc') updateScore(1);
                else if(type === 'bomb') updateScore(-5);
                else if(type === 'card') { updateScore(10); showCardPopup(imgSrc); }
            };
            document.getElementById('game-area').appendChild(el);
        }

        function showCardPopup(src) {
            isPausedForInfo = true; // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù„Ø¹Ø¨Ø©
            const popup = document.getElementById('info-popup');
            popup.src = src;
            popup.style.display = 'block';
            setTimeout(() => {
                popup.style.display = 'none';
                isPausedForInfo = false; // Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø¹Ø¯ 10 Ø«ÙˆØ§Ù†Ù
            }, 10000);
        }

        function updateScore(v) { score += v; if(score < 0) score = 0; document.getElementById('score-val').innerText = score; }

        function finishLevel() { clearInterval(spawnInterval); goToLevel(currentLevel + 1); }

        function setupQuizLevel(lvl) {
            showScene('scene-quiz');
            const q = document.getElementById('quiz-question');
            const o = document.getElementById('quiz-options');
            const f = document.getElementById('quiz-feedback');
            o.innerHTML = ''; f.innerText = '';

            if(lvl === 4) {
                q.innerText = "ÙŠØ°ÙƒØ±Ù†ÙŠ Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ø£Ø­Ù…Ø± Ø¨Ù€:";
                createOpt(o, "Ø§Ù„Ø¯Ù…", true); createOpt(o, "Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ø£Ø·Ù„Ø³ÙŠ", false); createOpt(o, "Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ø§Ø¯ÙŠ", false);
            } else if(lvl === 5) {
                q.innerText = "ÙŠØ°ÙƒØ±Ù†ÙŠ Ø§Ù„ØªÙ†ÙŠÙ† Ø§Ù„Ø°ÙŠ Ù‡Ø§Ø¬Ù… Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ø£Ø­Ù…Ø± Ø¨Ù€:";
                createOpt(o, "Ø³Ø±Ø·Ø§Ù† Ø§Ù„Ø¯Ù…", false); createOpt(o, "Ø§Ù„Ù„ÙˆÙƒÙŠÙ…ÙŠØ§", false); createOpt(o, "ÙƒÙ„Ø§Ù‡Ù…Ø§ ØµØ­ÙŠØ­", true);
            } else if(lvl === 6) {
                q.innerText = "Ù…Ø§ Ù‡ÙŠ Ù‡ÙˆÙŠØ© Ø§Ù„Ù…Ø­Ø§Ø±Ø¨ Ø³ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŸ";
                let inp = document.createElement('input'); inp.style.cssText = "width:80%; padding:15px; font-size:1.2rem; border-radius:10px; margin-bottom:20px; text-align:center;";
                let b = document.createElement('button'); b.className = "game-btn"; b.innerText = "ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©";
                b.onclick = () => {
                    if(["ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø¯Ù… Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡", "Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ù†Ø§Ø¹ÙŠ", "Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ø¯Ù… Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡"].includes(inp.value.trim())) { f.innerText = "Ø£Ø­Ø³Ù†Øª!"; setTimeout(() => goToLevel(7), 1500); }
                    else { f.innerText = "Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ÙŠØ§ Ø¨Ø·Ù„"; }
                };
                o.append(inp, b);
            }
        }

        function createOpt(cont, txt, corr) {
            let b = document.createElement('button'); b.className = "game-btn"; b.style.width = "100%"; b.style.margin = "10px 0"; b.innerText = txt;
            b.onclick = () => { if(corr) { document.getElementById('quiz-feedback').innerText = "Ø±Ø§Ø¦Ø¹! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©"; setTimeout(() => goToLevel(currentLevel+1), 1000); } else { document.getElementById('quiz-feedback').innerText = "ÙÙƒØ± Ù…Ø¬Ø¯Ø¯Ø§Ù‹..."; updateScore(-2); } };
            cont.appendChild(b);
        }

        function startBossLevel() {
            showScene('scene-boss');
            const grid = document.getElementById('fort-grid');
            grid.innerHTML = '';
            for(let i=0; i<25; i++) {
                let b = document.createElement('div'); b.className = 'brick'; b.dataset.hp = 3;
                b.onclick = () => {
                    if(score <= 0) { loseGame(); return; }
                    updateScore(-1); b.dataset.hp--; b.style.opacity = b.dataset.hp / 3;
                    if(b.dataset.hp <= 0) { b.style.visibility = 'hidden'; checkBossWin(); }
                };
                grid.appendChild(b);
            }
            bossInterval = setInterval(() => {
                bossTimer--; document.getElementById('timer-val').innerText = bossTimer;
                if(bossTimer <= 0) loseGame();
            }, 1000);
        }

        function checkBossWin() { if(document.querySelectorAll('.brick[style*="hidden"]').length === 25) { clearInterval(bossInterval); winGame(); } }

        function loseGame() { clearInterval(bossInterval); showScene('scene-lose'); document.getElementById('lose-video').play(); }

        function winGame() {
            playVideo('win.mp4', () => {
                showScene('scene-image');
                document.getElementById('display-img').src = assets.images.bossReveal;
                document.getElementById('scene-img-btn').style.display = 'none';
                setTimeout(() => startTypingSequence(), 30000); // Ø¥Ø·Ø§Ù„Ø© Ø§Ù„Ù…Ø¯Ø© Ù„Ù€ 30 Ø«Ø§Ù†ÙŠØ©
            });
        }

        function startTypingSequence() {
            showScene('scene-text-end');
            const el = document.getElementById('typewriter');
            const msg = "Ù…Ù† Ø§Ù„Ù‚Ù„Ø¨ Ø¥Ù„Ù‰ Ø£Ø·ÙØ§Ù„ Ø§Ù„Ø¹Ø§Ù„Ù…: Ø¹ÙØ´ØªÙ… Ø£ØµØ­Ø§Ø¡ØŒ Ù…ØªÙØ§Ø¦Ù„ÙŠÙ†ØŒ Ø¢Ù…Ù†ÙŠÙ†";
            let i = 0;
            typingSound.play(); typingSound.loop = true;
            let intv = setInterval(() => {
                el.innerText += msg.charAt(i); i++;
                if(i >= msg.length) { clearInterval(intv); setTimeout(replaceFinalWord, 1000); }
            }, 100);
        }

        function replaceFinalWord() {
            const el = document.getElementById('typewriter');
            el.innerHTML = el.innerText.replace("Ø£Ø·ÙØ§Ù„", "<span class='highlight-hero'>Ø£Ø¨Ø·Ø§Ù„</span>");
            typingSound.pause();
            setTimeout(() => {
                el.style.transition = "opacity 3s"; el.style.opacity = 0;
                setTimeout(() => {
                    playVideo('End.mp4', () => {
                        document.getElementById('end-video').pause();
                        document.getElementById('home-btn').style.display = 'inline-block';
                    });
                }, 3000);
            }, 10000);
        }
    </script>
</body>
</html>
